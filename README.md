## gRPC for Cisco IOS-XR in python

Author: Karthik Kumaravel

This package contains a library with the methods that are available to use over gRPC with IOS-XR boxes after 6.0.0. The api have several methods that allow a user to send simple rpc commands like, get & push using yang and json.

The repo is consisted of few main componenets, the compiled pb2 file from the proto and a python module accessing the pb2 file with the library bindings. The repo also includes examples on how to use the library to interact with an IOS-XR device.

At the bottom of the repo, there is a walkthrough of how to create your own client. 

If you find any problems or need help, create an issue. 

## Installing

Either download this repository or install it from pip:

`pip install iosxr_grpc`

(It is always recommened to do all work in a virutal environment like pipenv)



## GRPC Calls

#### Enable gRPC on the router:

- ssh into the router and turn on grpc on the router, below is an example configuration.

```
interface GigabitEthernet 0/0/0/0
 ipv4 address 192.168.1.2 255.255.255.0
 no shut

grpc
 port 57777
 !
!
```

**If you want to use TLS:**

Example config:

```
grpc
  tls
  port 57777
  !
!
```

(note: default port is 57400, and ipv4 only)

Copy the autogenerated .pem file to the 'keys' folder in the client directory.

```
scp cisco@192.168.1.2:/misc/config/grpc/ems.pem ./
```



#### Import and use:

```
from iosxr_grpc.cisco_grpc_client import CiscoGRPCClient
client = CiscoGRPCClient(
    <ip address>,
    <port>,
    <timeout>,
    <username>,
    <password>,
    <optional: tls key>,
    <optional: tls server name ('ems.cisco.com')>)
path = <yang path> # '{"openconfig-interfaces:interfaces": [null]}')
err, result = client.<operation>(path) # client.getconfig(path)
```

from iosxr_grpc.cisco_grpc_client import CiscoGRPCClient



For a more in-depth look, check out the wiki https://github.com/cisco-grpc-connection-libs/ios-xr-grpc-python/wiki

## Getting here from the beginning

To create a client of your own there are a few steps to follow.

- Download the proto file for IOS-XR's grpc: https://github.com/CiscoDevNet/grpc-getting-started
- Follow the instructions to generate the client/server code in python using the grpc-getting-started's proto file: http://www.grpc.io/docs/tutorials/basic/python.html#generating-client-and-server-code
- From here create a client, an example can be found here: http://www.grpc.io/docs/tutorials/basic/python.html#creating-the-client
- At this point you should have a client similar to the one in this repo

## Other Useful Links

If you would like to test this all out with IOS-XRv, use the following link to request access to the vagrant box.

https://xrdocs.github.io/

## Projects that use the python client

[Solenoid](https://github.com/ios-xr/Solenoid) - App that injects routes directly into Cisco's IOS-XR RIB table.

[Pipedown](https://github.com/cisco-ie/Pipedown) - CDN router monitoring tool for data center connectivity.

